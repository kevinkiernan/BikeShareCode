---
title: "BikeShare Project"
##"Why Do People Ride the Capital BikeShare?"
author: "Kevin Kiernan, Eric Christiansen, Ruijia Yang"
date: "12/5/2019"
output: 
  ioslides_presentation:
    widescreen: true
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(ggplot2)
library(shiny)
library(dplyr)
library(tidyr)
```
## Ridership Since 2010
#### People don't use this service in the winter
```{r}
load("RidershipData.rds")
#monthly_counts_duration<-monthly_counts
#total_counts_duration<-total_counts

#mode_bin_duration<-which(total_counts_duration$total_counts==max(total_counts_duration$total_counts))
#median_bin_duration<-mean(monthly_counts_duration$Duration.Median)
ridership_long<-gather(ridership,'Member.rides','Casual.rides',key=Type,value=Count)
#Histogram for duration
ridership.plot<-ggplot(ridership_long,aes(x=Date,y=Count,fill=Type))+
  geom_area()+
  theme_light()

renderPlot(ridership.plot,width=1000,height=400)
```


## Ride Duration
```{r}
load("TripDurationData.rds")
monthly_counts_duration<-monthly_counts
total_counts_duration<-total_counts

mode_bin_duration<-which(total_counts_duration$total_counts==max(total_counts_duration$total_counts))
median_bin_duration<-mean(monthly_counts_duration$Duration.Median)

#Histogram for duration
full.duration.hist<-ggplot(total_counts_duration,aes(x=bins,y=total_counts))+
  geom_bar(stat='identity',color="blue",fill="light blue")+
  geom_vline(xintercept=mode_bin_duration, linetype="dotted", color="black", size=0.75)+
  geom_vline(xintercept=median_bin_duration, linetype="dotted", color="black", size=0.75)+
  annotate(geom="text", x=5, y=1800000, label="Modal Ride= 5-6 Minutes",color="black",hjust=-0.01)+
  annotate(geom="text", x=11, y=1200000, label="Median Ride= 11 Minutes",color="black",hjust=-0.01)+
  labs(title="The Modal Ride Lasts 5-6 Minutes",
       subtitle="Rideshare Data from 2010-2019",
       y="Count",
       x="Ride Duration in Minutes")+
  ylim(0,2000000)+
  theme_light()

renderPlot(full.duration.hist)
```

## Ride Distance
```{r}
load("TripDistanceData.rds")
monthly_counts_distance<-monthly_counts
total_counts_distance<-total_counts

mode_bin_distance<-which(total_counts_distance$total_counts==max(total_counts_distance$total_counts))
median_bin_distance<-mean(monthly_counts_distance$Distance.Median)

#Histogram for Distance
full.distance.hist<-ggplot(total_counts_distance,aes(x=bins,y=total_counts))+
  geom_bar(stat='identity',color="blue",fill="light blue")+
  geom_vline(xintercept=total_counts_distance$bins[mode_bin_distance], linetype="dotted", color="black", size=0.75)+
  geom_vline(xintercept=median_bin_distance, linetype="dotted", color="black", size=0.75)+
  annotate(geom="text", x=total_counts_distance$bins[mode_bin_distance], 
           y=5000000, label="Modal Ride= 1/2 Mile",color="black",hjust=-0.01)+
  annotate(geom="text", x=median_bin_distance, 
           y=4500000, label="Median Ride=3/4 Mile",color="black",hjust=-0.01)+
  labs(title="The Modal Ride is About Half a Mile",
       subtitle="Rideshare Data from 2010-2019",
       y="Count",
       x="Ride Length in Miles")+
  xlim(-0.25,5)+
  theme_light()

renderPlot(full.distance.hist)
```

## People Overwhelmingly Ride North-South
```{r}
load("TripHeadingData.rds")
monthly_counts_heading<-monthly_counts
total_counts_heading<-total_counts

#Histogram for heading
full.heading.hist<-ggplot(total_counts_heading,aes(x=bins,y=total_counts))+
  geom_bar(stat='identity',color="blue",fill="light blue")+
  labs(subtitle="Rideshare Data from 2010-2019",
       y="Count of Total Trips",
       x="Trip Heading")+
  xlim(0,360)+
  ylim(0,600000)+
  coord_polar()+
  theme_light()

renderPlot(full.heading.hist)
```

## Stock Viz
```{r eruptions}
inputPanel(
  selectInput("n_breaks", label = "Number of bins:",
              choices = c(10, 20, 35, 50), selected = 20),
  
  sliderInput("bw_adjust", label = "Bandwidth adjustment:",
              min = 0.2, max = 2, value = 1, step = 0.2)
)

renderPlot({
  hist(faithful$eruptions, probability = TRUE, breaks = as.numeric(input$n_breaks),
       xlab = "Duration (minutes)", main = "Geyser eruption duration")
  
  dens <- density(faithful$eruptions, adjust = input$bw_adjust)
  lines(dens, col = "blue")
})
```

